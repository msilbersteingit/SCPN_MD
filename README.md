# Ne_calculator

Ne_caculator calculates the number of entanglements of bulk polymer MD models by measuring the contour length of primitive path of each macromolecular chain. The contour length is computed from the volume of each confining tube. The volume is measured by counting the number of grid points on which the confining tubes fall. This method prevents the contour length of primitive path from being overestimated, enabling to calculate an accurate number of entanglements.

## Getting Started

### dump.PP
A dump file corresponding a primitive path network, which is an input file to be read in.

### run.sh
Runs the main program (Neq_mpi.f) on every single primitive path.
User changes only the following variables.
```
num_procs=544 # number of processors
num_chains=27 # number of macromolecular chains
num_atoms=54000 # number of total atoms
num_atoms_per_mol=2000 # number of atoms of each molecule
griddel=0.5 # grid size
rvdw=0.95 # probe radius
```
### Neq_mpi.f
The main program that generates a fine mesh (3D grid) for every single primitive path and counts the number of grid points on which primitive path falls in order to not double count segments.

### var.default
Default parameters. This file is generated by running 'run.sh'

### var.options
Parameters that user changes. This file is generate by running 'run.sh'

### postprocess.py
Ne is a statistical property, so Ne is calculated by using the contour length of all primitive paths.
User changes two variables, num_chains and num_atoms_per_mol corresponding to the total number of macromolecular chains and atoms in one molecule.

## Running
```
bash run.sh
```
This will compile the code and write output files whose prefix is 'stdout.'.

```
python postprocess.py
```
This calculates a statistical property, Ne, by averaging over stdout's.

# internb

Finter.f and Fintra.f calculate inter- and intramolecular forces on the basis of coordinates and force field parameters.

# sim_scripts.txt
sim_scripts include LAMMPS simulation setup and parameters.

# Reference
@article{doi:10.1021/acs.macromol.8b01027,	
author = {Bae, Suwon and Galant, Or and Diesendruck, Charles E. and Silberstein, Meredith N.},	
title = {The Effect of Intrachain Cross-Linking on the Thermomechanical Behavior of Bulk Polymers Assembled Solely from Single Chain Polymer Nanoparticles},	
journal = {Macromolecules},	
volume = {51},	
number = {18},	
pages = {7160-7168},	
year = {2018},
doi = {10.1021/acs.macromol.8b01027},
URL = {
https://doi.org/10.1021/acs.macromol.8b01027
}

}
